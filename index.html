<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sistema Integrado de Consulta de Servidores - DGF</title>

<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Segoe UI', sans-serif;
    background: #f4f6f9;
}

/* ===== BARRA SUPERIOR ===== */
.topbar {
    background: #002b5c;
    color: white;
    padding: 18px 30px;
    font-size: 18px;
    font-weight: 600;
}

.topbar small {
    display: block;
    font-size: 12px;
    font-weight: 400;
    opacity: 0.8;
}

.gold-line {
    height: 4px;
    background: #c9a227;
}

/* ===== ÁREA CENTRAL ===== */
.main {
    display: flex;
    justify-content: center;
    align-items: center;
    height: calc(100vh - 110px);
}

.container {
    background: white;
    padding: 40px;
    border-radius: 12px;
    width: 460px;
    box-shadow: 0 15px 40px rgba(0,0,0,0.1);
}

h2 {
    text-align: center;
    margin-bottom: 25px;
    color: #002b5c;
}

/* ===== CAMPOS ===== */
input {
    width: 100%;
    padding: 12px;
    border-radius: 6px;
    border: 1px solid #ccc;
    margin-bottom: 12px;
    font-size: 14px;
}

/* ===== BOTÕES ===== */
button {
    width: 100%;
    padding: 12px;
    border-radius: 6px;
    border: none;
    background: #003366;
    color: white;
    font-weight: 600;
    cursor: pointer;
    margin-bottom: 8px;
    transition: 0.2s;
}

button:hover {
    background: #002244;
}

.secondary {
    background: #5c6f82;
}

.secondary:hover {
    background: #4b5c6b;
}

.logout {
    background: #8b0000;
}

.logout:hover {
    background: #6e0000;
}

.hidden { display: none; }

.response {
    margin-top: 15px;
    background: #f1f3f6;
    padding: 15px;
    border-radius: 8px;
    min-height: 60px;
    font-size: 14px;
    border-left: 4px solid #002b5c;
}

.footer {
    text-align: center;
    padding: 15px;
    font-size: 12px;
    color: #555;
    background: #e9edf2;
}
</style>
</head>

<body>

<div class="topbar">
    Secretaria Estadual de Pernambuco - Diretoria Geral de Finanças
    <small>Sistema Interno Oficial</small>
</div>

<div class="gold-line"></div>

<div class="main">
<div class="container">

    <!-- LOGIN -->
    <div id="loginArea">
        <h2>Sistema Integrado de Consulta de Servidores - DGF</h2>

        <input type="text" id="usuario" placeholder="Usuário institucional">
        <input type="password" id="senha" placeholder="Senha">
        <button onclick="login()">Entrar no Sistema</button>
    </div>

    <!-- SISTEMA INTERNO -->
    <div id="sistemaArea" class="hidden">
        <h2>Assistente de Consulta</h2>

        <input type="text" id="pergunta" placeholder="Digite nome ou consulta funcional...">
        <button onclick="consultar()">Consultar</button>
        <button class="secondary" onclick="limpar()">Nova Consulta</button>
        <button class="logout" onclick="logout()">Encerrar Sessão</button>

        <div class="response" id="resposta"></div>
    </div>

</div>
</div>

<div class="footer">
    © 2026 - Diretoria Geral de Finanças (DGF) • Uso interno e restrito
</div>

<script>

const API_URL = "https://script.google.com/macros/s/AKfycbxpXRSc5LcL7yW_2St6q28CQzMj5nR4YI4pHEWQKHZ2Fgym1EWvbTW1ME5Qu0cKp9Mc/exec";

async function consultar() {

    const campo = document.getElementById("nome");
    const resultado = document.getElementById("resultado");

    const perguntaOriginal = campo.value.trim();

    if (!perguntaOriginal) {
        resultado.innerHTML = "Digite algo para consultar.";
        return;
    }

    const pergunta = perguntaOriginal.toLowerCase();

    let nome = perguntaOriginal;
    let tipo = "todos";

    if (pergunta.includes("chefe")) {
        tipo = "chefe";
        nome = pergunta.split("de")[1]?.trim();
    }
    else if (pergunta.includes("empresa")) {
        tipo = "empresa";
        nome = pergunta.split("de")[1]?.trim();
    }
    else if (pergunta.includes("setor")) {
        tipo = "setor";
        nome = pergunta.split("de")[1]?.trim();
    }
    else if (pergunta.includes("cargo")) {
        tipo = "cargo";
        nome = pergunta.split("de")[1]?.trim();
    }

    try {

        const response = await fetch(API_URL + "?nome=" + encodeURIComponent(nome));
        const dados = await response.json();

        if (dados.erro) {
            resultado.innerHTML = dados.erro;
            return;
        }

        if (!Array.isArray(dados)) {
            resultado.innerHTML = "Formato inesperado.";
            return;
        }

        let html = "";

        dados.forEach(func => {

            const nomeResp   = func.Nome   || func.nome   || "";
            const cargoResp  = func.Cargo  || func.cargo  || "";
            const setorResp  = func.Setor  || func.setor  || "";
            const chefeResp  = func.Chefe  || func.chefe  || "";
            const empresaResp= func.Empresa|| func.empresa|| "";

            if (tipo === "chefe") {
                html += `<p><strong>${nomeResp}</strong> → Chefe: ${chefeResp}</p>`;
            }
            else if (tipo === "empresa") {
                html += `<p><strong>${nomeResp}</strong> → Empresa: ${empresaResp}</p>`;
            }
            else if (tipo === "setor") {
                html += `<p><strong>${nomeResp}</strong> → Setor: ${setorResp}</p>`;
            }
            else if (tipo === "cargo") {
                html += `<p><strong>${nomeResp}</strong> → Cargo: ${cargoResp}</p>`;
            }
            else {
                html += `
                    <div style="margin-bottom:15px;">
                        <strong>Nome:</strong> ${nomeResp}<br>
                        <strong>Cargo:</strong> ${cargoResp}<br>
                        <strong>Setor:</strong> ${setorResp}<br>
                        <strong>Chefe:</strong> ${chefeResp}<br>
                        <strong>Empresa:</strong> ${empresaResp}
                    </div>
                `;
            }

        });

        resultado.innerHTML = html;

    } catch (erro) {
        resultado.innerHTML = "Erro ao consultar sistema.";
        console.error(erro);
    }

}

</script>


</body>
</html>

